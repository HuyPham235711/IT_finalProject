python - <<'PY'
from transformers import AutoModelForSequenceClassification
from safetensors.torch import load_file

# ðŸ”¹ Load weights tá»« file safetensors
weights = load_file("./finbert_finetuned_safe/model.safetensors")

# ðŸ”¹ Táº¡o model base tá»« FinBERT gá»‘c
base = AutoModelForSequenceClassification.from_pretrained("ProsusAI/finbert", num_labels=3)

# ðŸ”¹ Bá» prefix "model." khá»i keys
clean_weights = {k.replace("model.", ""): v for k, v in weights.items() if k.startswith("model.")}

missing, unexpected = base.load_state_dict(clean_weights, strict=False)
print("âœ… Loaded fine-tuned weights into base model")
print("Missing keys:", missing)
print("Unexpected keys:", unexpected)

# ðŸ”¹ Save láº¡i model sáº¡ch Ä‘á»ƒ pipeline hiá»ƒu Ä‘Æ°á»£c
base.save_pretrained("./finbert_finetuned_safe_pure2")

print("âœ… Saved clean model to ./finbert_finetuned_safe_pure2")
PY
